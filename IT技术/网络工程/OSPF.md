### 定义

- 开放式最短路径优先，基于链路状态特征（不是基于距离矢量）
- 工作在IP层，协议号89

### 初始化流程

1. 建立邻居和邻接关系
	- 发送hello报文发现和建立邻居关系，组播地址224.0.0.5
		- 接口up
		- 双方接口在同一网段，同一区域
		- ......
	- 选举DR/BDR,建立邻接关系（打比方：关系好的邻居建立邻接关系），（DR:指定路由器，BDR：备份DR），路由链路状态信息发送给DR
		- DR/BDR选举
			- 选举原因 广播网络中使路由信息交换更加告诉有序
			- 选举范围 每条**广播链路**上都需要选出一个DR和BDR
			- 选举规则 
				1. 优先级数字大的优先 默认优先级都是1
				2. Router-id大的优先
			- Router-id 
				-  定义 Rid,标识路由器身份
				- 产生方法
					- 手动配置一个IPV4地址格式作为Rid
					- 自动选举
						1. 在所有回环口中选举ip地址最大的作为Rid
						2. 在所有物理接口中选举IP地址最大的作为Rid
					- 建议手动配置一个本地回环口的ip地址作为Rid
		- 关系状态
			- DRother与DR建立邻接关系
			- DRother与BDR建立邻接关系
			- DR与BDR建立邻接关系
			- 两个DRother之间保持邻居关系
2. 邻接路由器之间交换链路状态信息，实现区域内链路状态数据同步
	- 相关概念
		 - 链路状态通告
			- LSA
			- 用来描述路由器的接口，路由条目相关信息
		- 链路状态数据库
			- LSDB
			- 存储本地所有LSA
	- 工作流程
			1. 向邻接路由器发送DD报文，通告本地LSDB中所有LSA的摘要信息
			2. 收到DD报文后，与本地LSDB对比，向对方发送LSR报文，请求发送本机所需的LSA完整信息
			3. 收到LSR后，把对方所需的LSA的完整信息打包为一条LSU报文，发送至对方
			4. 收到LSU后，向对方发送LSAck报文，进行确认
3. 每台路由器根据本机链路状态数据库，计算到达每个目的网段的最优路由，写入路由表

### 报文类型

- Hello报文
- DD报文
	- 数据库描述报文
	- 用于描述本地LSDB中所有LSA的摘要
- LSR报文
	- 链路状态请求
- LSU报文
	- 链路状态更新
- LSAck报文
	- 链路状态确认

### 分区域管理

- 原因
	- 加快收敛速度
	- 把网路故障隔离在区域内部
- 路由器角色
	- IR 内部路由器 所有接口都处于同一个区域
	- ABR 区域边界路由器 连接不同区域的路由器
	- ASBR 自治系统边界路由器 连接外部自治系统的路由器
	
- 区域类型
	- 骨干区域
		- 只能有一个骨干区域，一般是区域0
		- 骨干区域必须是连接的
	- 非骨干区域
		- 非骨干区域必须连接到骨干区域
		- 为了防止区域间形成路由闭环

### 配置

